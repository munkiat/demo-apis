name: Deploy APIs

on:
  workflow_dispatch:

jobs:
  deploy:
    env:
      dashboard_url: ${{ secrets.DASHBOARD_URL }}
      dash_key: ${{ secrets.DASHBOARD_SECRET }}
    runs-on: ubuntu-latest
    name: Deploy Tyk APIs
    steps:
     - run: echo "starting sync"
     - run: echo "${{ runner.os }} operating system"
     - name: Check Out
       uses: actions/checkout@v4
     - run: |
         curl -s https://packagecloud.io/install/repositories/tyk/tyk-sync/script.deb.sh | sudo bash
     - run: |
         sudo apt-get install tyk-sync=1.5
     - run: |
         /opt/tyk-sync/tyk-sync sync -d="$dashboard" -s="$dash_key" -p="."
